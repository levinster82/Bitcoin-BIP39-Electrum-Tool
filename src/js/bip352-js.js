!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.BIP352=r():e.BIP352=r()}(this,()=>{return e={44:(e,r,t)=>{const{bech32m:n}=t(343),o="sp",s="tsp";function i(e,r=0,t=0){const n=e.deriveHardened(352).deriveHardened(t).deriveHardened(r);return{scanKey:n.deriveHardened(1).derive(0),spendKey:n.deriveHardened(0).derive(0)}}function c(e,r,t=0){if(33!==e.length)throw new Error("Scan pubkey must be 33-byte compressed public key");if(2!==e[0]&&3!==e[0])throw new Error("Scan pubkey must be in compressed format (0x02 or 0x03 prefix)");if(33!==r.length)throw new Error("Spend pubkey must be 33-byte compressed public key");if(2!==r[0]&&3!==r[0])throw new Error("Spend pubkey must be in compressed format (0x02 or 0x03 prefix)");const i=1===t?s:o,c=new Uint8Array(66);c.set(e,0),c.set(r,33);const d=[0,...f([...c],8,5,!0)];return n.encode(i,d,1023)}function f(e,r,t,n){let o=0,s=0;const i=[],c=(1<<t)-1;for(const n of e){if(n<0||n>>r!==0)throw new Error("Invalid data");for(o=o<<r|n,s+=r;s>=t;)s-=t,i.push(o>>s&c)}if(n)s>0&&i.push(o<<t-s&c);else if(s>=r||o<<t-s&c)throw new Error("Invalid padding");return i}e.exports={PURPOSE_BIP352:352,COIN_TYPE_BTC_MAINNET:0,COIN_TYPE_BTC_TESTNET:1,VERSION_SP:0,HRP_SP_MAINNET:o,HRP_SP_TESTNET:s,deriveKeys:i,toAddress:c,fromAddress:function(e){let r;try{r=n.decode(e,1023)}catch(e){throw new Error(`Invalid Silent Payment address: ${e.message}`)}const{prefix:t,words:i}=r;if(t!==o&&t!==s)throw new Error(`Invalid HRP: ${t}`);const c=i[0];if(0!==c)throw new Error(`Unsupported Silent Payment version: ${c}`);const d=f(i.slice(1),5,8,!1);if(66!==d.length)throw new Error(`Invalid payload length ${d.length}, expected 66`);const u=new Uint8Array(d),a=u.slice(0,33),l=u.slice(33,66);if(2!==a[0]&&3!==a[0])throw new Error("Invalid scan pubkey format");if(2!==l[0]&&3!==l[0])throw new Error("Invalid spend pubkey format");return{version:c,scanPub:a,spendPub:l,testnet:t===s}},deriveAddress:function(e,r=0,t=0){const{scanKey:n,spendKey:o}=i(e,r,t);return{address:c(n.publicKey,o.publicKey,t),scanKey:n,spendKey:o}},getPath:function(e,r=0,t=0){return`m/352'/${t}'/${r}'/${"scan"===e?1:0}'/0`}}},343:(e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.bech32m=r.bech32=void 0;const t="qpzry9x8gf2tvdw0s3jn54khce6mua7l",n={};for(let e=0;e<32;e++){const r=t.charAt(e);n[r]=e}function o(e){const r=e>>25;return(33554431&e)<<5^996825010&-(1&r)^642813549&-(r>>1&1)^513874426&-(r>>2&1)^1027748829&-(r>>3&1)^705979059&-(r>>4&1)}function s(e){let r=1;for(let t=0;t<e.length;++t){const n=e.charCodeAt(t);if(n<33||n>126)return"Invalid prefix ("+e+")";r=o(r)^n>>5}r=o(r);for(let t=0;t<e.length;++t){const n=e.charCodeAt(t);r=o(r)^31&n}return r}function i(e,r,t,n){let o=0,s=0;const i=(1<<t)-1,c=[];for(let n=0;n<e.length;++n)for(o=o<<r|e[n],s+=r;s>=t;)s-=t,c.push(o>>s&i);if(n)s>0&&c.push(o<<t-s&i);else{if(s>=r)return"Excess padding";if(o<<t-s&i)return"Non-zero padding"}return c}function c(e){return i(e,8,5,!0)}function f(e){const r=i(e,5,8,!1);if(Array.isArray(r))return r}function d(e){const r=i(e,5,8,!1);if(Array.isArray(r))return r;throw new Error(r)}function u(e){let r;function i(e,t){if(t=t||90,e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";const i=e.toLowerCase(),c=e.toUpperCase();if(e!==i&&e!==c)return"Mixed-case string "+e;const f=(e=i).lastIndexOf("1");if(-1===f)return"No separator character for "+e;if(0===f)return"Missing prefix for "+e;const d=e.slice(0,f),u=e.slice(f+1);if(u.length<6)return"Data too short";let a=s(d);if("string"==typeof a)return a;const l=[];for(let e=0;e<u.length;++e){const r=u.charAt(e),t=n[r];if(void 0===t)return"Unknown character "+r;a=o(a)^t,e+6>=u.length||l.push(t)}return a!==r?"Invalid checksum for "+e:{prefix:d,words:l}}return r="bech32"===e?1:734539939,{decodeUnsafe:function(e,r){const t=i(e,r);if("object"==typeof t)return t},decode:function(e,r){const t=i(e,r);if("object"==typeof t)return t;throw new Error(t)},encode:function(e,n,i){if(i=i||90,e.length+7+n.length>i)throw new TypeError("Exceeds length limit");let c=s(e=e.toLowerCase());if("string"==typeof c)throw new Error(c);let f=e+"1";for(let e=0;e<n.length;++e){const r=n[e];if(r>>5)throw new Error("Non 5-bit word");c=o(c)^r,f+=t.charAt(r)}for(let e=0;e<6;++e)c=o(c);c^=r;for(let e=0;e<6;++e)f+=t.charAt(c>>5*(5-e)&31);return f},toWords:c,fromWordsUnsafe:f,fromWords:d}}r.bech32=u("bech32"),r.bech32m=u("bech32m")}},r={},function t(n){var o=r[n];if(void 0!==o)return o.exports;var s=r[n]={exports:{}};return e[n](s,s.exports,t),s.exports}(44);var e,r});